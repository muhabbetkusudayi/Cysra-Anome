<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>New Tab</title>
<style>
*, *::before, *::after { margin:0; padding:0; box-sizing:border-box; }
:root {
  --bg:#202124; --surface:rgba(255,255,255,0.05); --surface2:rgba(255,255,255,0.09);
  --border:rgba(255,255,255,0.08); --text:#e8eaed; --text2:#9aa0a6; --text3:#5f6368;
  --accent:#5b8dee; --accent-glow:rgba(91,141,238,0.13);
  --input-bg:rgba(255,255,255,0.05); --input-focus:rgba(255,255,255,0.09);
  --input-bdr:rgba(255,255,255,0.08); --input-bdr-focus:#5b8dee;
}
:root.light {
  --bg:#f8f9fa; --surface:rgba(0,0,0,0.04); --surface2:rgba(0,0,0,0.07);
  --border:rgba(0,0,0,0.08); --text:#202124; --text2:#5f6368; --text3:#9aa0a6;
  --accent:#1a73e8; --accent-glow:rgba(26,115,232,0.10);
  --input-bg:rgba(0,0,0,0.04); --input-focus:#ffffff;
  --input-bdr:rgba(0,0,0,0.10); --input-bdr-focus:#1a73e8;
}
html, body { width:100%; min-height:100vh; background:var(--bg); color:var(--text);
  font-family:-apple-system,"Segoe UI","Helvetica Neue",Arial,sans-serif;
  -webkit-font-smoothing:antialiased; transition:background 0.25s, color 0.25s; }
body { display:flex; flex-direction:column; align-items:center; padding-bottom:80px; overflow-x:hidden; }
/* Logo çok büyük olduğu için wrap genişliğini artırdım */
.wrap { width:100%; max-width:920px; padding:0 20px; display:flex; flex-direction:column; align-items:center; }

.hero { margin-top:60px; display:flex; flex-direction:column; align-items:center;
  gap:0; opacity:0; animation:rise 0.5s ease 0.05s forwards; }

/* BOYUT 8 KATINA ÇIKARILDI (110px -> 880px) */
.logo-wrap { position:relative; width:600px; height:100px; margin-bottom:100px; max-width:100%; }
.logo-img { width:880px; height:880px; border-radius:120px; object-fit:contain; display:block; max-width:100%; }
.logo-fallback { width:880px; height:880px; border-radius:120px; background:var(--accent);
  display:none; align-items:center; justify-content:center;
  font-size:400px; font-weight:800; color:#fff; letter-spacing:-2px; max-width:100%; }

.clock { font-size:76px; font-weight:200; letter-spacing:-4px; color:var(--text);
  line-height:1; font-variant-numeric:tabular-nums; }
.date-line { font-size:14px; color:var(--text2); font-weight:400; margin-top:8px; letter-spacing:0.1px; }

.search-wrap { width:100%; max-width:640px; margin-top:38px; position:relative; opacity:0; animation:rise 0.5s ease 0.15s forwards; }
.search-input { width:100%; background:var(--input-bg); border:1.5px solid var(--input-bdr);
  border-radius:50px; padding:15px 52px 15px 22px; font-size:15px; color:var(--text);
  font-family:inherit; outline:none; transition:background 0.15s, border-color 0.15s, box-shadow 0.15s; }
.search-input::placeholder { color:var(--text3); }
.search-input:focus { background:var(--input-focus); border-color:var(--input-bdr-focus);
  box-shadow:0 0 0 3px var(--accent-glow); }
.search-icon { position:absolute; right:18px; top:50%; transform:translateY(-50%);
  width:18px; height:18px; color:var(--text3); pointer-events:none; opacity:0.5; }

.section { width:100%; max-width:640px; margin-top:38px; opacity:0; }
.section.visible { animation:rise 0.45s ease forwards; }
.section-title { font-size:11px; font-weight:700; color:var(--text2);
  letter-spacing:0.8px; text-transform:uppercase; margin-bottom:13px; }

.mv-row { display:flex; gap:14px; }
.mv-card { flex:1; min-width:0; display:flex; flex-direction:column; align-items:center;
  gap:10px; padding:22px 12px 18px; background:var(--surface); border:1px solid var(--border);
  border-radius:16px; cursor:pointer; text-decoration:none; color:var(--text);
  transition:background 0.12s, transform 0.12s, box-shadow 0.12s; user-select:none; }
.mv-card:hover { background:var(--surface2); transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(0,0,0,0.18); }
.mv-icon-wrap { width:48px; height:48px; border-radius:14px; overflow:hidden; display:flex;
  align-items:center; justify-content:center; font-size:20px; font-weight:700; color:#fff;
  flex-shrink:0; background:var(--accent); }
.mv-icon-wrap img { width:32px; height:32px; object-fit:contain; border-radius:8px; }
.mv-name { font-size:12px; font-weight:600; color:var(--text); text-align:center;
  max-width:100%; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.mv-visits { font-size:10px; color:var(--text3); text-align:center; }
.mv-empty { text-align:center; color:var(--text3); font-size:13px; padding:18px 0; width:100%; }

.fav-grid { display:grid; grid-template-columns:repeat(auto-fill, minmax(92px, 1fr)); gap:10px; }
.fav-card { display:flex; flex-direction:column; align-items:center; gap:8px;
  padding:15px 8px 13px; background:var(--surface); border:1px solid var(--border);
  border-radius:14px; cursor:pointer; text-decoration:none; color:var(--text);
  transition:background 0.12s, transform 0.12s; user-select:none; }
.fav-card:hover { background:var(--surface2); transform:translateY(-1px); }
.fav-icon-wrap { width:36px; height:36px; border-radius:10px; overflow:hidden; display:flex;
  align-items:center; justify-content:center; font-size:15px; font-weight:700; color:#fff; flex-shrink:0; }
.fav-icon-wrap img { width:24px; height:24px; object-fit:contain; border-radius:6px; }
.fav-name { font-size:11px; font-weight:500; color:var(--text2); text-align:center;
  max-width:80px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.fav-empty { text-align:center; color:var(--text3); font-size:13px; padding:18px 0; width:100%; }

@keyframes rise { from{opacity:0;transform:translateY(10px)} to{opacity:1;transform:translateY(0)} }
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:transparent; }
::-webkit-scrollbar-thumb { background:var(--border); border-radius:3px; }
::-webkit-scrollbar-thumb:hover { background:var(--accent); }
</style>
</head>
<body>
<div class="wrap">

  <div class="hero">
    <div class="logo-wrap">
      <img src="icon.png" alt="Cysra" class="logo-img" id="logo-img"
        onerror="document.getElementById('logo-img').style.display='none';document.getElementById('logo-fb').style.display='flex';">
      <div class="logo-fallback" id="logo-fb">C</div>
    </div>
    <div class="clock" id="clock">00:00</div>
    <div class="date-line" id="dateline">Monday, January 1</div>
  </div>

  <div class="search-wrap">
    <input class="search-input" id="search" type="text"
      placeholder="Search or enter web address" autocomplete="off" spellcheck="false">
    <svg class="search-icon" viewBox="0 0 24 24" fill="none"
         stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <circle cx="11" cy="11" r="7"/>
      <line x1="21" y1="21" x2="16.65" y2="16.65"/>
    </svg>
  </div>

  <div class="section" id="mv-section">
    <div class="section-title">Most Visited</div>
    <div class="mv-row" id="mv-row">
      <div class="mv-empty">Visit some sites to see them here</div>
    </div>
  </div>

  <div class="section" id="fav-section">
    <div class="section-title">Favorites</div>
    <div class="fav-grid" id="fav-grid">
      <div class="fav-empty">Star a page to add it here</div>
    </div>
  </div>

</div>

<script>
"use strict";
var COLORS=["#5b8dee","#81c995","#f28b82","#fdd663","#c58af9","#ff8bcb","#78d9ec","#ffb86c"];

function updateClock(){
  var now=new Date();
  document.getElementById("clock").textContent=String(now.getHours()).padStart(2,"0")+":"+String(now.getMinutes()).padStart(2,"0");
  var days=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  var months=["January","February","March","April","May","June","July","August","September","October","November","December"];
  document.getElementById("dateline").textContent=days[now.getDay()]+", "+months[now.getMonth()]+" "+now.getDate();
}
setInterval(updateClock,1000);
updateClock();

document.getElementById("search").addEventListener("keydown",function(e){
  if(e.key!=="Enter")return;
  var val=this.value.trim();
  if(!val)return;
  if(/^https?:\/\//.test(val)||(/\./.test(val)&&!/\s/.test(val))){
    window.location.href=/^https?:\/\//.test(val)?val:"https://"+val;
  }else{
    window.location.href="https://www.duckduckgo.com/search?q="+encodeURIComponent(val);
  }
});

function domainOf(url){try{return new URL(url).hostname.replace(/^www\./,"");}catch(e){return url.slice(0,18);}}
function faviconOf(url){try{return "https://www.google.com/s2/favicons?sz=64&domain="+new URL(url).hostname;}catch(e){return null;}}

function applyTheme(theme){
  if(theme==="light"){document.documentElement.classList.add("light");}
  else{document.documentElement.classList.remove("light");}
}

function makeFaviconIcon(url, colorIdx){
  var wrap=document.createElement("div");
  wrap.className="mv-icon-wrap";
  wrap.style.background=COLORS[colorIdx%COLORS.length];
  var fv=faviconOf(url);
  if(fv){
    var img=document.createElement("img");
    img.src=fv;
    img.onerror=function(){try{wrap.removeChild(img);}catch(x){}wrap.textContent=domainOf(url).charAt(0).toUpperCase();};
    wrap.appendChild(img);
  }else{
    wrap.textContent=domainOf(url).charAt(0).toUpperCase();
  }
  return wrap;
}

function makeFavSmallIcon(url, colorIdx){
  var wrap=document.createElement("div");
  wrap.className="fav-icon-wrap";
  wrap.style.background=COLORS[colorIdx%COLORS.length];
  var fv=faviconOf(url);
  if(fv){
    var img=document.createElement("img");
    img.src=fv;
    img.onerror=function(){try{wrap.removeChild(img);}catch(x){}wrap.textContent=domainOf(url).charAt(0).toUpperCase();};
    wrap.appendChild(img);
  }else{
    wrap.textContent=domainOf(url).charAt(0).toUpperCase();
  }
  return wrap;
}

function renderMostVisited(items){
  var row=document.getElementById("mv-row");
  var section=document.getElementById("mv-section");
  row.innerHTML="";
  if(!items||items.length===0){
    row.innerHTML='<div class="mv-empty">Visit some sites to see them here</div>';
    section.classList.add("visible");return;
  }
  items.slice(0,3).forEach(function(site,i){
    var card=document.createElement("a");
    card.className="mv-card";card.href=site.url;card.title=site.url;
    var iconWrap=makeFaviconIcon(site.url,i);
    var name=document.createElement("div");
    name.className="mv-name";
    var domain=domainOf(site.url);
    name.textContent=domain.length<22?domain:domain.slice(0,20)+"…";
    var visits=document.createElement("div");
    visits.className="mv-visits";
    visits.textContent=site.count+(site.count===1?" visit":" visits");
    card.appendChild(iconWrap);card.appendChild(name);card.appendChild(visits);
    row.appendChild(card);
  });
  section.classList.add("visible");
}

function renderFavorites(items){
  var grid=document.getElementById("fav-grid");
  var section=document.getElementById("fav-section");
  grid.innerHTML="";
  if(!items||items.length===0){
    grid.innerHTML='<div class="fav-empty">Star a page to add it here</div>';
    section.classList.add("visible");return;
  }
  items.forEach(function(fav,i){
    var card=document.createElement("a");
    card.className="fav-card";card.href=fav.url;card.title=fav.url;
    var iconWrap=makeFavSmallIcon(fav.url,i);
    var name=document.createElement("div");
    name.className="fav-name";
    var title=fav.title||domainOf(fav.url);
    name.textContent=title.length>14?title.slice(0,12)+"…":title;
    card.appendChild(iconWrap);card.appendChild(name);
    grid.appendChild(card);
  });
  section.classList.add("visible");
}

window.onCysraData=function(data){
  if(data.theme)        applyTheme(data.theme);
  if(data.most_visited) renderMostVisited(data.most_visited);
  if(data.favorites)    renderFavorites(data.favorites);
};

if(window._CYSRA){window.onCysraData(window._CYSRA);}

setTimeout(function(){
  document.getElementById("mv-section").classList.add("visible");
  document.getElementById("fav-section").classList.add("visible");
},350);
</script>
</body>
</html>